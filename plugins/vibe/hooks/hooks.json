{
  "hooks": {
    "SessionStart": [
      {
        "matcher": "startup",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/session-cleanup.js",
            "timeout": 5,
            "statusMessage": "清理殘留進程..."
          }
        ]
      },
      {
        "matcher": "startup|resume|clear|compact",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/pipeline-init.js",
            "timeout": 10,
            "statusMessage": "初始化工作環境..."
          }
        ]
      },
      {
        "matcher": "startup|resume|clear|compact",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/dashboard-autostart.js",
            "timeout": 5,
            "statusMessage": "檢查 Dashboard..."
          }
        ]
      },
      {
        "matcher": "startup|resume|clear|compact",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/remote-hub.js autostart",
            "timeout": 5,
            "statusMessage": "檢查遠端服務..."
          }
        ]
      }
    ],
    "UserPromptSubmit": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "prompt",
            "model": "claude-haiku-4-5-20251001",
            "prompt": "你是開發任務分類器。根據使用者的自然語言輸入，判斷最適合的開發 pipeline。\n\n關鍵原則：分析使用者的主要意圖，不要被附屬子句的措辭干擾。\n例如「繼續尋找有沒有遺留跟斷裂並優化」→ 主意圖是「優化/重構」，不是問問題。\n例如「幫我看看這個 bug 然後修掉」→ 主意圖是「修 bug」，不是「看看」。\n\n可用 pipeline：\n- full: 新功能（含 UI）\n- standard: 新功能（無 UI）、大重構\n- quick-dev: bugfix + 補測試、小改動\n- fix: hotfix、config、一行修改\n- test-first: TDD 工作流\n- ui-only: 純 UI/樣式調整\n- review-only: 程式碼審查\n- docs-only: 純文件更新\n- security: 安全修復（REVIEW 含安全審查）\n- none: 問答、研究、trivial\n\n分類原則：\n- 純粹問問題、查資料、探索、聊天、打招呼、確認（好/OK/繼續）→ none\n- 修 typo、改名、改設定、一行修改 → fix\n- Bug 修復 + 需要測試驗證 → quick-dev\n- 新功能、新系統、新模組（含 UI）→ full\n- 新功能、新系統、新模組（無 UI）→ standard\n- 重構、優化、改善、改進既有程式碼 → standard\n- TDD 工作流（先寫測試再實作）→ test-first\n- 純 UI/樣式調整 → ui-only\n- 程式碼審查 → review-only\n- 純文件更新（.md/README/CHANGELOG）→ docs-only\n- 安全漏洞修復 → security\n- 不確定時選 none（保守策略）\n\n回覆格式（嚴格 JSON）：\n- 需要 pipeline → {\"decision\":\"allow\",\"systemMessage\":\"此需求適合 [pipeline:ID]。請使用對應 skill 開始委派。\"}\n- 不需要 → {\"decision\":\"allow\"}"
          }
        ]
      },
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/task-classifier.js",
            "timeout": 5,
            "statusMessage": "分析任務類型..."
          }
        ]
      },
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/remote-hub.js prompt-forward",
            "timeout": 5
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Task",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/delegation-tracker.js",
            "timeout": 5
          }
        ]
      },
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/pipeline-guard.js",
            "timeout": 5
          }
        ]
      },
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/suggest-compact.js",
            "timeout": 5
          }
        ]
      },
      {
        "matcher": "AskUserQuestion",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/remote-hub.js ask-intercept",
            "timeout": 60
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/post-edit.js",
            "timeout": 20,
            "statusMessage": "檢查程式碼品質..."
          }
        ]
      }
    ],
    "PreCompact": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/log-compact.js",
            "timeout": 5
          }
        ]
      }
    ],
    "SubagentStop": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/stage-transition.js",
            "timeout": 10,
            "statusMessage": "處理 pipeline 轉換..."
          }
        ]
      },
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/remote-hub.js sender",
            "timeout": 10
          }
        ]
      }
    ],
    "Stop": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/pipeline-check.js",
            "timeout": 10,
            "statusMessage": "檢查工作完整性..."
          }
        ]
      },
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/task-guard.js",
            "timeout": 10,
            "statusMessage": "檢查任務完成狀態..."
          }
        ]
      },
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/check-console-log.js",
            "timeout": 10,
            "statusMessage": "檢查殘留 debug 程式碼..."
          }
        ]
      },
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/dashboard-refresh.js",
            "timeout": 30,
            "statusMessage": "同步 Dashboard..."
          }
        ]
      },
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/hooks/remote-hub.js receipt",
            "timeout": 10
          }
        ]
      }
    ]
  }
}
